<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.tireshoppingmall.home.auth.MemberMapper">

<insert id="regMember"  parameterType="com.tireshoppingmall.home.auth.MemberDTO">
		insert all 
		into auth_user values(auth_user_seq.nextval, #{u_id}, 1) 
		into auth_password values(auth_user_seq.nextval , 'test' , #{pw_password}, sysdate)
		into auth_userinfo values(auth_user_seq.nextval , #{i_name} ,#{i_phoneNum},sysdate, 1,#{i_email})
		<if test='i_carnum != "" '>
		into my_car values(#{i_carnum} , auth_user_seq.nextval ,#{i_carname},
		#{i_carbrand}, #{i_caryear})
		</if>
		SELECT * FROM DUAL
</insert>


<insert id="regMemberSocial"  parameterType="com.tireshoppingmall.home.auth.MemberDTO">
	insert all 
		into auth_user values(auth_user_seq.nextval, #{u_id}, 1) 
		into auth_password values(auth_user_seq.nextval , 'test' , 'social', sysdate)
		into auth_userinfo values(auth_user_seq.nextval , #{i_name} ,#{i_phoneNum},sysdate, 1,#{i_email}) 
		SELECT * FROM DUAL
</insert>

<select id="checkMember" resultType="string">
	select pw_password from auth_user,auth_password 
	where u_no=pw_no and u_id=#{u_id}
</select>

<select id="getMember" resultType="com.tireshoppingmall.home.auth.AuthUserDTO">
	select *
	from auth_user,auth_userinfo
	<if test='i_carnum != null '>
	,my_car 
	</if>
	where auth_user.u_no=auth_userinfo.i_no 
	<if test='i_carnum != null '>
	and auth_user.u_no= my_car.mc_id 
	</if>
	and u_id=#{u_id}
		
</select>
<select id="getSocialMember" resultType="com.tireshoppingmall.home.auth.AuthUserDTO">
	select *
	from auth_user,auth_userinfo 
	<if test="i_carnum != ''">
	,my_car 
	</if>
	where auth_user.u_no=auth_userinfo.i_no 
	<if test="i_carnum != ''">
	and auth_user.u_no= my_car.mc_id 
	</if>
	and u_id=#{socialID}
</select>


<select id="checkIDkko" resultType="int">
	select count(*) from auth_user where u_id=#{ID}
</select>

<select id="getMyOrder" resultType="com.tireshoppingmall.home.admin.order.OrderDTO">
	select * from product_order where O_SORTATION=#{u_no}
</select>



</mapper>